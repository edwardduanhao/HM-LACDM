% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_vb.R
\name{compute_elbo}
\alias{compute_elbo}
\title{Compute Evidence Lower Bound (ELBO)}
\usage{
compute_elbo(
  y,
  delta_mat,
  m_beta,
  v_beta,
  m_beta_prior,
  v_beta_prior,
  alpha,
  alpha_prior,
  omega,
  omega_prior,
  e_z,
  e_zz,
  xi
)
}
\arguments{
\item{y}{A torch tensor of shape (i, t, j) containing binary response,
data where i is the number of individuals, t is the number of time points,
and j is the number of items}

\item{delta_mat}{A list of length j containing design matrices for
each item, where each element is a torch tensor of shape (l, k+1)}

\item{m_beta}{A list of length j containing posterior mean vectors for
item-effect parameters (beta)}

\item{v_beta}{A list of length j containing posterior covariance matrices
for item-effect parameters (beta)}

\item{m_beta_prior}{A list of length j containing prior mean vectors for
item-effect parameters (beta)}

\item{v_beta_prior}{A list of length j containing prior covariance matrices
for item-effect parameters (beta)}

\item{alpha}{A torch tensor of shape (l,) containing posterior Dirichlet
parameters for the initial distribution, where l = 2^k}

\item{alpha_prior}{A torch tensor of shape (l,) containing prior Dirichlet
parameters for the initial distribution}

\item{omega}{A torch tensor of shape (l, l) containing posterior Dirichlet
parameters for the transition matrix}

\item{omega_prior}{A torch tensor of shape (l, l) containing prior Dirichlet
parameters for the transition matrix}

\item{e_z}{A torch tensor of shape (i, t, l) containing expected latent
class memberships}

\item{e_zz}{A torch tensor of shape (i, t-1, l, l) containing expected
transition counts between consecutive time points}

\item{xi}{A torch tensor of shape (j, l) containing auxiliary variational
parameters for the Jaakkola-Jordan bound}
}
\value{
A scalar value representing the Evidence Lower Bound (ELBO)
}
\description{
Computes the Evidence Lower Bound (ELBO) for the Hidden Markov Log-Linear
Cognitive Diagnostic Model using variational inference. The ELBO serves as
a lower bound on the log marginal likelihood and is used to monitor
convergence and assess model fit.
}
\details{
The ELBO is computed as the sum of expected log-likelihood terms
minus KL divergences between posterior and prior distributions. It includes
contributions from item responses, latent class memberships, transitions,
and all model parameters. Higher ELBO values indicate better model fit.
}
\examples{
\dontrun{
# Assuming all required tensors and parameters are available
elbo_value <- compute_elbo(
  y, delta_mat, m_beta, v_beta,
  m_beta_prior, v_beta_prior, alpha, alpha_prior,
  omega, omega_prior, e_z, e_zz, xi
)
}

}
