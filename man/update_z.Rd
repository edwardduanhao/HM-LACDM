% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_vb.R
\name{update_z}
\alias{update_z}
\title{Update Latent Attribute Expectations (Z)}
\usage{
update_z(log_phi, log_kappa, log_eta, epsilon = 1e-10)
}
\arguments{
\item{log_phi}{A torch tensor of shape (i, t, l) containing the log item
response probabilities for each individual, time point, and latent class}

\item{log_kappa}{A torch tensor of shape (l,) containing the log initial
distribution parameters for latent classes}

\item{log_eta}{A torch tensor of shape (l, l) containing the log transition
probability matrix between latent classes}

\item{epsilon}{A small positive value to avoid numerical instability
(default: 1e-10)}
}
\value{
A list containing:
\itemize{
\item First element: A torch tensor of shape (i, t, l) with expected
latent class memberships
\item Second element: A torch tensor of shape (i, t-1, l, l) with
expected transition counts between consecutive time points
}
}
\description{
Computes the expected latent class memberships and transition counts
using the forward-backward algorithm for the Hidden Markov Log-Linear
Cognitive Diagnostic Model.
}
\details{
This function implements the forward-backward algorithm to compute
the posterior expectations of latent class memberships and transitions.
The algorithm uses log-space computations to maintain numerical stability.
}
\examples{
\dontrun{
# Assuming appropriate torch tensors are available
result <- update_z(log_phi, log_kappa, log_eta)
e_z <- result[[1]]
e_z_inter <- result[[2]]
}

}
