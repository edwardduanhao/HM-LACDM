% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_vb.R
\name{q_mat_recovery}
\alias{q_mat_recovery}
\title{Q-Matrix Recovery via Statistical Testing}
\usage{
q_mat_recovery(
  beta_hat,
  beta_hat_sd,
  beta_hat_trace,
  alpha_level = 0.05,
  q_mat_true = NULL
)
}
\arguments{
\item{beta_hat_trace}{A tensor of shape (max_iter, j, k+1) containing the
trace of beta parameter estimates across iterations}

\item{alpha_level}{Significance level for the Benjamini-Hochberg procedure
(default: 0.05)}

\item{q_mat_true}{Optional true Q-matrix of shape (j, k) for evaluating
recovery accuracy. If provided, permutation search is performed to
find the best attribute ordering (default: NULL)}

\item{m_beta}{A list of length j containing posterior mean vectors for
item-effect parameters (beta), where each element is a torch tensor}

\item{v_beta}{A list of length j containing posterior covariance matrices
for item-effect parameters (beta), where each element is a torch tensor}
}
\value{
If q_mat_true is NULL, returns a binary matrix Q_hat of shape (j, k).
If q_mat_true is provided, returns a list containing:
\itemize{
\item q_mat_hat: Recovered Q-matrix with optimal attribute ordering
\item acc: Recovery accuracy (proportion of correctly identified entries)
\item beta_hat: Parameter estimates with optimal ordering
\item beta_hat_sd: Parameter standard deviations with optimal ordering
\item beta_hat_trace: Parameter traces with optimal ordering
\item ord: Optimal attribute ordering indices
}
}
\description{
Performs post-hoc Q-matrix recovery by testing the significance of
item-effect parameters using Benjamini-Hochberg multiple testing correction
and optional permutation search for optimal attribute ordering.
}
\details{
This function identifies which attributes are required for each item
by testing if the corresponding item-effect parameters are significantly
greater than zero. It uses the Benjamini-Hochberg procedure to control
the false discovery rate. When a true Q-matrix is provided, it searches
over all possible attribute permutations to find the ordering that
maximizes recovery accuracy.
}
\examples{
\dontrun{
# Basic Q-matrix recovery
q_mat_recovered <- q_mat_recovery(m_beta, v_beta, beta_trace)

# With true Q-matrix for evaluation
result <- q_mat_recovery(m_beta, v_beta, beta_trace, q_mat_true = true_Q)
best_q_mat <- result$q_mat_hat
accuracy <- result$acc
}

}
